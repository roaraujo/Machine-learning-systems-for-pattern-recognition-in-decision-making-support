# Chunk 1: setup
# paramentros padrao para os plots
knitr::opts_chunk$set(fig.width = '\\textwidth',
fig.align = 'center',
out.width = "\\textwidth",
warning = FALSE, echo = TRUE)
library(robustbase)
library(knitr)
library(stargazer)
library(tidyverse)
library(gamlss)
library(car)
library(readxl)
library(MASS)
library(gridExtra)
library(ggplot2)
library(faraway)
# Chunk 2
require(BatchGetSymbols)
require(Amelia)
require(reshape2)
require(ggthemes)
require(plyr)
# Chunk 3
suppressMessages(library(foreign))
suppressMessages(library(dynlm))
suppressMessages(library(car))
suppressMessages(library(lmtest))
suppressMessages(library(sandwich))
suppressMessages(library(fpp2))
suppressMessages(library(zoo))
suppressMessages(library(forecast))
library(quantmod)
library(fpp2)
library(GeneCycle)
# Chunk 4
library(matrixStats)
library(ggplot2)
library(ggradar)
library(corrplot)
library(tidyverse)
library(cluster)
library(factoextra)
library(gridExtra)
library(dplyr)
library(caret)
library(lattice)
library(ggplot2)
library(GGally)
library(ggcorrplot)
library(scales)
library(pROC)
library(dplyr)
library(ggraph)
library(igraph)
# Chunk 5
plotaroc <- function(rocobj, titulo = "Curva ROC"){
# Função que plota as curvas roc para os modelos ajustados
b <- which.max(rocobj$sensitivities + rocobj$specificities)
best <- round(c(rocobj$thresholds[b],rocobj$specificities[b],rocobj$sensitivities[b]), 3)
pROC::ggroc(rocobj, col = "red", alpha = 0.5, size = 0.5) +
theme_gray() +
ggtitle(titulo) +
geom_abline(intercept = 1, slope=1, linetype = "dashed") +
labs(x="Especificidade", y = "Sensibilidade")  +
geom_point(data = tibble(Sensibilidade = best[2],
Especificidade = best[3]),
mapping = aes(x=Sensibilidade, y=Especificidade),
col = "black") +
geom_text(mapping =  aes(x = best[2] - 0.15,
y = best[3] - 0.05),
label = paste( best[1], "(", best[2], ",", best[3], ")")) +
geom_text(mapping = aes(x = 0.5,
y = 0.01),
label = paste("AUC: ", round(rocobj$auc,3)))
}
tree_func <- function(final_model,
tree_num) {
# get tree by index
tree <- randomForest::getTree(final_model,
k = tree_num,
labelVar = TRUE) %>%
tibble::rownames_to_column() %>%
# make leaf split points to NA, so the 0s won't get plotted
mutate(`split point` = ifelse(is.na(prediction), `split point`, NA))
# prepare data frame for graph
graph_frame <- data.frame(from = rep(tree$rowname, 2),
to = c(tree$`left daughter`, tree$`right daughter`))
# convert to graph and delete the last node that we don't want to plot
graph <- graph_from_data_frame(graph_frame) %>%
delete_vertices("0")
# set node labels
V(graph)$node_label <- gsub("_", " ", as.character(tree$`split var`))
V(graph)$leaf_label <- as.character(tree$prediction)
V(graph)$split <- as.character(round(tree$`split point`, digits = 2))
# plot
plot <- ggraph(graph, 'dendrogram') +
theme_bw() +
geom_edge_link() +
geom_node_point() +
geom_node_text(aes(label = node_label), na.rm = TRUE, repel = TRUE) +
geom_node_label(aes(label = split), vjust = 2, na.rm = TRUE, fill = "white") +
geom_node_label(aes(label = leaf_label, fill = leaf_label), na.rm = TRUE,
repel = TRUE, colour = "white", fontface = "bold", show.legend = FALSE) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
plot.background = element_rect(fill = "white"),
panel.border = element_blank(),
axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(size = 14))
return(plot)
}
X_train <- read.csv("C:\\Users\\Rodrigo Araujo\\Documents\\Mestrado - UFBA\\Dissertação\\mestrado-ufba\\Artigo\\X_train.csv", sep=';')
X_test <- read.csv("C:\\Users\\Rodrigo Araujo\\Documents\\Mestrado - UFBA\\Dissertação\\mestrado-ufba\\Artigo\\X_test.csv", sep=';')
y_train <- read.csv("C:\\Users\\Rodrigo Araujo\\Documents\\Mestrado - UFBA\\Dissertação\\mestrado-ufba\\Artigo\\X_train.csv", sep=';')
y_test <- read.csv("C:\\Users\\Rodrigo Araujo\\Documents\\Mestrado - UFBA\\Dissertação\\mestrado-ufba\\Artigo\\X_test.csv", sep=';')
head(X_train) %>% kable(caption="Dados.")
# Chunk 1: setup
# paramentros padrao para os plots
knitr::opts_chunk$set(fig.width = '\\textwidth',
fig.align = 'center',
out.width = "\\textwidth",
warning = FALSE, echo = TRUE)
library(robustbase)
library(knitr)
library(stargazer)
library(tidyverse)
library(gamlss)
library(car)
library(readxl)
library(MASS)
library(gridExtra)
library(ggplot2)
library(faraway)
# Chunk 2
require(BatchGetSymbols)
require(Amelia)
require(reshape2)
require(ggthemes)
require(plyr)
# Chunk 3
suppressMessages(library(foreign))
suppressMessages(library(dynlm))
suppressMessages(library(car))
suppressMessages(library(lmtest))
suppressMessages(library(sandwich))
suppressMessages(library(fpp2))
suppressMessages(library(zoo))
suppressMessages(library(forecast))
library(quantmod)
library(fpp2)
library(GeneCycle)
# Chunk 4
library(matrixStats)
library(ggplot2)
library(ggradar)
library(corrplot)
library(tidyverse)
library(cluster)
library(factoextra)
library(gridExtra)
library(dplyr)
library(caret)
library(lattice)
library(ggplot2)
library(GGally)
library(ggcorrplot)
library(scales)
library(pROC)
library(dplyr)
library(ggraph)
library(igraph)
# Chunk 5
plotaroc <- function(rocobj, titulo = "Curva ROC"){
# Função que plota as curvas roc para os modelos ajustados
b <- which.max(rocobj$sensitivities + rocobj$specificities)
best <- round(c(rocobj$thresholds[b],rocobj$specificities[b],rocobj$sensitivities[b]), 3)
pROC::ggroc(rocobj, col = "red", alpha = 0.5, size = 0.5) +
theme_gray() +
ggtitle(titulo) +
geom_abline(intercept = 1, slope=1, linetype = "dashed") +
labs(x="Especificidade", y = "Sensibilidade")  +
geom_point(data = tibble(Sensibilidade = best[2],
Especificidade = best[3]),
mapping = aes(x=Sensibilidade, y=Especificidade),
col = "black") +
geom_text(mapping =  aes(x = best[2] - 0.15,
y = best[3] - 0.05),
label = paste( best[1], "(", best[2], ",", best[3], ")")) +
geom_text(mapping = aes(x = 0.5,
y = 0.01),
label = paste("AUC: ", round(rocobj$auc,3)))
}
tree_func <- function(final_model,
tree_num) {
# get tree by index
tree <- randomForest::getTree(final_model,
k = tree_num,
labelVar = TRUE) %>%
tibble::rownames_to_column() %>%
# make leaf split points to NA, so the 0s won't get plotted
mutate(`split point` = ifelse(is.na(prediction), `split point`, NA))
# prepare data frame for graph
graph_frame <- data.frame(from = rep(tree$rowname, 2),
to = c(tree$`left daughter`, tree$`right daughter`))
# convert to graph and delete the last node that we don't want to plot
graph <- graph_from_data_frame(graph_frame) %>%
delete_vertices("0")
# set node labels
V(graph)$node_label <- gsub("_", " ", as.character(tree$`split var`))
V(graph)$leaf_label <- as.character(tree$prediction)
V(graph)$split <- as.character(round(tree$`split point`, digits = 2))
# plot
plot <- ggraph(graph, 'dendrogram') +
theme_bw() +
geom_edge_link() +
geom_node_point() +
geom_node_text(aes(label = node_label), na.rm = TRUE, repel = TRUE) +
geom_node_label(aes(label = split), vjust = 2, na.rm = TRUE, fill = "white") +
geom_node_label(aes(label = leaf_label, fill = leaf_label), na.rm = TRUE,
repel = TRUE, colour = "white", fontface = "bold", show.legend = FALSE) +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
panel.background = element_blank(),
plot.background = element_rect(fill = "white"),
panel.border = element_blank(),
axis.line = element_blank(),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(size = 14))
return(plot)
}
# Chunk 6
X_train <- read.csv("C:\\Users\\Rodrigo Araujo\\Documents\\Mestrado - UFBA\\Dissertação\\mestrado-ufba\\Artigo\\X_train.csv", sep=';')
X_test <- read.csv("C:\\Users\\Rodrigo Araujo\\Documents\\Mestrado - UFBA\\Dissertação\\mestrado-ufba\\Artigo\\X_test.csv", sep=';')
y_train <- read.csv("C:\\Users\\Rodrigo Araujo\\Documents\\Mestrado - UFBA\\Dissertação\\mestrado-ufba\\Artigo\\X_train.csv", sep=';')
y_test <- read.csv("C:\\Users\\Rodrigo Araujo\\Documents\\Mestrado - UFBA\\Dissertação\\mestrado-ufba\\Artigo\\X_test.csv", sep=';')
head(X_train) %>% kable(caption="Dados.")
X_train = X_train  %>% dplyr::select('RFV','H2RFV','CONICITY',
'PLY','LFV','RRO', 'CAPSPLICE')
X_test = X_test  %>% dplyr::select('RFV','H2RFV','CONICITY',
'PLY','LFV','RRO', 'CAPSPLICE')
X_train$GR = as.factor(y_train)
View(X_train)
X_train = X_train  %>% dplyr::select('RFV','H2RFV','CONICITY',
'PLY','LFV','RRO', 'CAPSPLICE')
X_train$GR = y_train
View(X_train)
View(y_train)
X_train <- read.csv("C:\\Users\\Rodrigo Araujo\\Documents\\Mestrado - UFBA\\Dissertação\\mestrado-ufba\\Artigo\\X_train.csv", sep=';')
X_test <- read.csv("C:\\Users\\Rodrigo Araujo\\Documents\\Mestrado - UFBA\\Dissertação\\mestrado-ufba\\Artigo\\X_test.csv", sep=';')
y_train <- read.csv("C:\\Users\\Rodrigo Araujo\\Documents\\Mestrado - UFBA\\Dissertação\\mestrado-ufba\\Artigo\\y_train.csv", sep=';')
y_test <- read.csv("C:\\Users\\Rodrigo Araujo\\Documents\\Mestrado - UFBA\\Dissertação\\mestrado-ufba\\Artigo\\y_test.csv", sep=';')
head(X_train) %>% kable(caption="Dados.")
View(y_train)
X_train = X_train  %>% dplyr::select('RFV','H2RFV','CONICITY',
'PLY','LFV','RRO', 'CAPSPLICE')
X_test = X_test  %>% dplyr::select('RFV','H2RFV','CONICITY',
'PLY','LFV','RRO', 'CAPSPLICE')
X_train$GR = as.factor(y_train)
X_test$GR = as.factor(y_test)
View(X_train)
X_train$GR = y_train
View(X_train)
a = cbind(X_train, y_train)
View(a)
X_train = X_train  %>% dplyr::select('RFV','H2RFV','CONICITY',
'PLY','LFV','RRO', 'CAPSPLICE')
X_test = X_test  %>% dplyr::select('RFV','H2RFV','CONICITY',
'PLY','LFV','RRO', 'CAPSPLICE')
X_train = cbind(X_train, y_train)
X_test = cbind(X_test, y_test)
X_train$GR = as.factor(X_train$GR)
X_test$GR = as.factor(y_test$GR)
View(X_train)
X_train = X_train  %>% dplyr::select('RFV','H2RFV','CONICITY',
'PLY','LFV','RRO', 'CAPSPLICE')
X_test = X_test  %>% dplyr::select('RFV','H2RFV','CONICITY',
'PLY','LFV','RRO', 'CAPSPLICE')
train = cbind(X_train, y_train)
test = cbind(X_test, y_test)
train$GR = as.factor(train$GR)
test$GR = as.factor(test$GR)
library(nnet)
set.seed(31)
modeloRL1 <-  nnet::multinom(GR ~ ., data = train)
print(modeloRL1)
predictRL2 <- predict(modeloRL1, newdata = train)
caret::confusionMatrix(predictRL2, train$GR)
predictRL1 <- predict(modeloRL1, newdata = train)
caret::confusionMatrix(predictRL1, train$GR)
predictRL2 <- predict(modeloRL1, newdata = test)
caret::confusionMatrix(predictRL2, test$GR)
library(nnet)
set.seed(31)
modeloRL1 <-  nnet::multinom(GR ~ ., data = train)
print(modeloRL1)
predictRL1 <- predict(modeloRL1, newdata = train)
caret::confusionMatrix(predictRL1, train$GR)
predictRL2 <- predict(modeloRL1, newdata = test)
caret::confusionMatrix(predictRL2, test$GR)
View(X_test)
fit1<-aov(GR ~ ., data = train)
summary(fit1)
View(train)
fit1<-aov(RRO ~ GR, data = train)
summary(fit1)
par(mfrow=c(2,2))
plot(fit1)
posthoc.kruskal.nemenyi.test(RRO ~ GR, data=train)
require(stats)
posthoc.kruskal.nemenyi.test(RRO ~ GR, data=train)
library(PMCMR)
require(PMCMR)
posthoc.kruskal.nemenyi.test(RRO ~ GR, data=train)
vignette("PMCMR")
install.packages("PMCMR")
require(PMCMR)
posthoc.kruskal.nemenyi.test(RRO ~ GR, data=train)
install.packages("PMCMRplus")
library(PMCMRplus)
posthoc.kruskal.nemenyi.test(RRO ~ GR, data=train)
PMCMRplus::kwAllPairsNemenyiTest(RRO ~ GR, data=train)
h = PMCMRplus::kwAllPairsNemenyiTest(RRO ~ GR, data=train)
summary(h)
h = PMCMRplus::kwAllPairsNemenyiTest(CONICITY ~ GR, data=train)
summary(h)
h
h = PMCMRplus::kwAllPairsNemenyiTest(RFV ~ GR, data=train)
summary(h)
h = PMCMRplus::kwAllPairsNemenyiTest(RFV ~ GR, data=train)
summary(h)
## H2RFV
```{r}
h = PMCMRplus::kwAllPairsNemenyiTest(H2RFV ~ GR, data=train)
summary(h)
```
## PLY
```{r}
h = PMCMRplus::kwAllPairsNemenyiTest(PLY ~ GR, data=train)
summary(h)
```
## LFV
```{r}
h = PMCMRplus::kwAllPairsNemenyiTest(LFV ~ GR, data=train)
summary(h)
```
## CAPSPLICE
```{r}
h = PMCMRplus::kwAllPairsNemenyiTest(CAPSPLICE ~ GR, data=train)
summary(h)
```
## CAPSPLICE
```{r}
h = PMCMRplus::kwAllPairsNemenyiTest(CAPSPLICE ~ GR, data=train)
summary(h)
```
## CAPSPLICE
```{r}
h = PMCMRplus::kwAllPairsNemenyiTest(CAPSPLICE ~ GR, data=train)
summary(h)
```
